<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¥ BD Video Earnings with Mini App</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&family=Open+Sans&display=swap" rel="stylesheet">
<style>
@keyframes pulse {0%{transform:scale(1);}50%{transform:scale(1.03);}100%{transform:scale(1);}}
body {font-family:'Open Sans', sans-serif; background:linear-gradient(135deg,#56CCF2,#2F80ED); margin:0; padding:0; display:flex; justify-content:center; align-items:center; min-height:100vh;}
.container {background:#fff; padding:30px; border-radius:25px; box-shadow:0 12px 35px rgba(0,0,0,0.3); width:95%; max-width:480px; text-align:center; transition:transform 0.3s;}
.container:hover {transform:translateY(-5px);}
h2 {font-family:'Montserrat', sans-serif; color:#333; margin-bottom:20px;}
input {width:90%; padding:12px; margin:10px 0; border-radius:12px; border:1px solid #ccc; font-size:16px; transition:border 0.3s;}
input:focus {border-color:#2F80ED; outline:none;}
button {margin:10px 5px; padding:12px 20px; border:none; border-radius:15px; font-size:16px; color:#fff; cursor:pointer; transition:0.3s; display:inline-flex; align-items:center; justify-content:center;}
button:hover {opacity:0.85; transform:scale(1.05);}
#loginBtn {background:linear-gradient(45deg,#56CCF2,#2F80ED);}
#registerBtn {background:linear-gradient(45deg,#F2994A,#F2C94C);}
.watchBtn {background:linear-gradient(45deg,#EB5757,#FF6B6B); font-weight:bold; animation:none;}
#shareBtn {background:linear-gradient(45deg,#F2994A,#F2C94C);}
#cashoutBtn {background:linear-gradient(45deg,#27AE60,#2ECC71);}
#logoutBtn {background:linear-gradient(45deg,#EB5757,#E74C3C);}
#openMiniApp {background:linear-gradient(45deg,#9B51E0,#BB6BD9);}
#backToMain {background:linear-gradient(45deg,#2D9CDB,#56CCF2);}
button:disabled {background:#ccc; cursor:not-allowed; transform:none;}
.balance {font-size:26px; font-weight:bold; color:#2F80ED; margin:15px 0; transition:all 0.5s ease;}
#videoMsg, #loginMsg, #refMsg {font-size:16px; margin:10px 0; color:#555;}
#loginMsg {color:red; font-weight:bold;}
.video-list {text-align:left; margin:15px 0;}
.video-item {background:#f1f1f1; padding:12px; border-radius:12px; margin:8px 0; display:flex; justify-content:space-between; align-items:center;}
.share-icons {display:flex; justify-content:center; margin-top:10px;}
.share-icons button {margin:0 5px; padding:10px 15px; border-radius:12px; font-size:14px;}
#adModal {display:none; position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);justify-content:center;align-items:center; z-index:1000;}
#adModal .modal-content {background:#fff;padding:20px;border-radius:15px;max-width:400px;width:90%; text-align:center;}
@media(max-width:500px){.container{padding:25px;} input,button{font-size:14px;}}
</style>
</head>
<body>

<!-- Login/Register -->
<div class="container" id="loginDiv">
<h2>ğŸ”‘ Login / Register</h2>
<input type="email" id="email" placeholder="Email" required><br>
<input type="password" id="password" placeholder="Password" required><br>
<button id="loginBtn">Login</button>
<button id="registerBtn">Register</button>
<p id="loginMsg"></p>
</div>

<!-- Main App -->
<div class="container" id="appDiv" style="display:none;">
<h2>ğŸ¥ BD Video Earnings</h2>
<p class="balance">ğŸ’° Balance: <span id="balance">0</span> à§³</p>

<div class="video-list" id="videoList">
  <div class="video-item">Video 1 <button class="watchBtn" data-index="0">Watch</button></div>
  <div class="video-item">Video 2 <button class="watchBtn" data-index="1">Watch</button></div>
  <div class="video-item">Video 3 <button class="watchBtn" data-index="2">Watch</button></div>
  <div class="video-item">Video 4 <button class="watchBtn" data-index="3">Watch</button></div>
</div>
<p id="videoMsg"></p>

<button id="shareBtn">ğŸ Copy / Share Referral Link</button>
<p id="refMsg"></p>

<div class="share-icons">
<button onclick="shareLink('whatsapp')">WhatsApp</button>
<button onclick="shareLink('messenger')">Messenger</button>
<button onclick="shareLink('facebook')">Facebook</button>
</div>

<button id="cashoutBtn">ğŸ’¸ Cashout (Bkash/Nagad/Rocket)</button><br>
<button id="logoutBtn">ğŸšª Logout</button><br>
<button id="openMiniApp">ğŸ›  Open Mini App</button>
</div>

<!-- Mini App -->
<div class="container" id="miniAppDiv" style="display:none;">
<h2>ğŸ“± Mini App</h2>
<p>à¦à¦–à¦¾à¦¨à§‡ à¦¤à§‹à¦®à¦¾à¦° à¦¸à¦¾à¦¬-à¦…à§à¦¯à¦¾à¦ªà§‡à¦° à¦«à¦¿à¦šà¦¾à¦° à¦†à¦¸à¦¬à§‡à¥¤</p>
<button id="backToMain">ğŸ”™ Back to Main App</button>
</div>

<!-- Ad Modal -->
<div id="adModal">
  <div class="modal-content">
    <div id="adContainer"></div>
    <button id="closeAd">Close Ad</button>
  </div>
</div>

<script>
// Users Data
let users = JSON.parse(localStorage.getItem("users") || "{}");
let currentUser = localStorage.getItem("currentUser");

function saveUsers(){ localStorage.setItem("users", JSON.stringify(users)); }
function showApp(){ document.getElementById("loginDiv").style.display="none"; document.getElementById("appDiv").style.display="block"; loadBalance(); }
function loadBalance(){ let user=users[currentUser]; document.getElementById("balance").innerText=user.balance; }

// Register
document.getElementById("registerBtn").addEventListener("click",()=>{
let email=document.getElementById("email").value.trim();
let password=document.getElementById("password").value.trim();
if(!email||!password){ alert("Fill all fields"); return; }
if(users[email]){ document.getElementById("loginMsg").innerText="Email already exists, login instead."; return; }
let refCode=email.replace(/[@.]/g,''); 
users[email]={password:password, balance:0, lastWatch:[], refCode:refCode};
saveUsers();
currentUser=email; localStorage.setItem("currentUser",currentUser);
showApp();
});

// Login
document.getElementById("loginBtn").addEventListener("click",()=>{
let email=document.getElementById("email").value.trim();
let password=document.getElementById("password").value.trim();
if(users[email] && users[email].password===password){
currentUser=email; localStorage.setItem("currentUser",currentUser); showApp();
}else{ document.getElementById("loginMsg").innerText="Incorrect email or password."; }
});

// Logout
document.getElementById("logoutBtn").addEventListener("click",()=>{
localStorage.removeItem("currentUser"); currentUser=null;
document.getElementById("loginDiv").style.display="block";
document.getElementById("appDiv").style.display="none";
});

// Video Ads Scripts
let adScripts = [
  "//pl27496709.profitableratecpm.com/5d/d3/fb/5dd3fb19ff46ec13df9cbce0dc5e1b7b.js",
  "https://www.profitableratecpm.com/fseywmgr?key=2c425623f1ac9a75a48c4804dea0c855",
  "//pl27501001.profitableratecpm.com/b6/15/aa/b615aa44044fcfb95655fd07a5eebf6c.js",
  "//www.highperformanceformat.com/590e8d0a7a1712fe1cf2bca322cc5f6/invoke.js"
];
let videoRewards = [5,10,15,20];

// Load ad dynamically
function loadAd(index){
  let container = document.getElementById("adContainer");
  container.innerHTML = "";
  let script = document.createElement("script");
  script.src = adScripts[index];
  script.async = true;
  container.appendChild(script);
  document.getElementById("adModal").style.display="flex";

  document.getElementById("closeAd").onclick = function(){
    document.getElementById("adModal").style.display="none";
    alert(`ğŸ‰ Video ${index+1} complete! +${videoRewards[index]} à¦Ÿà¦¾à¦•à¦¾ à¦¯à§‹à¦— à¦¹à¦²à§‹`);
    users[currentUser].balance += videoRewards[index];
    loadBalance();
    saveUsers();
  };
}

// Video buttons
document.querySelectorAll(".watchBtn").forEach(btn=>{
  btn.addEventListener("click",()=>{
    let index = parseInt(btn.getAttribute("data-index"));
    loadAd(index);
  });
});

// Referral
document.getElementById("shareBtn").addEventListener("click",()=>{
  let user = users[currentUser];
  let link = `${window.location.href.split('?')[0]}?ref=${user.refCode}`;
  navigator.clipboard.writeText(link).then(()=>{ document.getElementById("refMsg").innerHTML=`âœ… Link copied: <a href="${link}" target="_blank">${link}</a>`; });
});
function shareLink(platform){
  let user = users[currentUser];
  let link = `${window.location.href.split('?')[0]}?ref=${user.refCode}`;
  let url="";
  if(platform==="whatsapp") url=`https://wa.me/?text=Join+and+earn+BDT videos: ${encodeURIComponent(link)}`;
  if(platform==="messenger") url=`https://www.facebook.com/dialog/send?link=${encodeURIComponent(link)}&app_id=1234567890&redirect_uri=${encodeURIComponent(link)}`;
  if(platform==="facebook") url=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`;
  window.open(url,"_blank");
}

// Cashout
document.getElementById("cashoutBtn").addEventListener("click",()=>{
  let user=users[currentUser];
  if(user.balance<=0){ alert("âŒ Balance empty! Watch videos or refer first."); return; }
  let mobile=prompt("Enter Bkash/Nagad/Rocket number:");
  if(mobile){ alert(`âœ… Success! ${user.balance} à§³ sent to ${mobile}.`); user.balance=0; loadBalance(); saveUsers();}
});

// Referral from URL
window.addEventListener('load',()=>{
  const params=new URLSearchParams(window.location.search);
  if(params.has('ref')){
    let ref=params.get('ref');
    for(let u in users){
      if(users[u].refCode===ref && u!==currentUser){ users[u].balance+=40; saveUsers(); break; }
    }
  }
  if(currentUser && users[currentUser]) showApp();
});

// Mini App Navigation
document.getElementById("openMiniApp").addEventListener("click",()=>{
  document.getElementById("appDiv").style.display="none";
  document.getElementById("miniAppDiv").style.display="block";
});
document.getElementById("backToMain").addEventListener("click",()=>{
  document.getElementById("miniAppDiv").style.display="none";
  document.getElementById("appDiv").style.display="block";
});
</script>
</body>
</html>